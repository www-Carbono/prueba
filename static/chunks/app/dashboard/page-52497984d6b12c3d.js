(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{5:function(e,t,n){Promise.resolve().then(n.bind(n,6815))},8064:function(e,t,n){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return s}});let l=n(4590);function s(e){let{createServerReference:t}=n(6671);return t(e,l.callServer)}},6815:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var l=n(7437),s=n(2265),r=n(7194),i=n(1575);function c(e,t){return t}n(4590);var a=n(8064),o=(0,a.$)("48a05acbfdd7c583ba6379ecdffe6f9fbe6d3574");(0,a.$)("9e2fca11bf50ffa4d01f68e5f3b19f3e32370288"),(0,a.$)("deba73553342435df872163beba2a50aabbc2aa2");var d=(0,a.$)("99eb1582c7716401ee16d51edc344bcaba86d1b9"),u=(0,a.$)("6b0d5dff0e46287831276fd6c1470e7ad1f53b89");(0,a.$)("53e54466931197ad5504d5a01ca9181c1acb5deb"),(0,a.$)("b676994d422eaaafc05c804443cf6c893d3f9427"),(0,a.$)("210b8650c582cced29ad8a2b51a30d318d546d51");let h=e=>{var t,n,l,i,a,u,h;let{type:x}=e,v=(0,r.D)(),[j,m]=(0,s.useState)(""),f=(0,s.useRef)(""),[y]=(l=(n=(0,s.useReducer)(c,j))[0],i=n[1],a=function(e,t,n){var l=this,r=(0,s.useRef)(null),i=(0,s.useRef)(0),c=(0,s.useRef)(null),a=(0,s.useRef)([]),o=(0,s.useRef)(),d=(0,s.useRef)(),u=(0,s.useRef)(e),h=(0,s.useRef)(!0);u.current=e;var x="undefined"!=typeof window,v=!t&&0!==t&&x;if("function"!=typeof e)throw TypeError("Expected a function");t=+t||0;var j=!!(n=n||{}).leading,m=!("trailing"in n)||!!n.trailing,f="maxWait"in n,y="debounceOnServer"in n&&!!n.debounceOnServer,b=f?Math.max(+n.maxWait||0,t):null;return(0,s.useEffect)(function(){return h.current=!0,function(){h.current=!1}},[]),(0,s.useMemo)(function(){var e=function(e){var t=a.current,n=o.current;return a.current=o.current=null,i.current=e,d.current=u.current.apply(n,t)},n=function(e,t){v&&cancelAnimationFrame(c.current),c.current=v?requestAnimationFrame(e):setTimeout(e,t)},s=function(e){if(!h.current)return!1;var n=e-r.current;return!r.current||n>=t||n<0||f&&e-i.current>=b},g=function(t){return c.current=null,m&&a.current?e(t):(a.current=o.current=null,d.current)},p=function e(){var l=Date.now();if(s(l))return g(l);if(h.current){var c=t-(l-r.current);n(e,f?Math.min(c,b-(l-i.current)):c)}},w=function(){if(x||y){var u=Date.now(),v=s(u);if(a.current=[].slice.call(arguments),o.current=l,r.current=u,v){if(!c.current&&h.current)return i.current=r.current,n(p,t),j?e(r.current):d.current;if(f)return n(p,t),e(r.current)}return c.current||n(p,t),d.current}};return w.cancel=function(){c.current&&(v?cancelAnimationFrame(c.current):clearTimeout(c.current)),i.current=0,a.current=r.current=o.current=c.current=null},w.isPending=function(){return!!c.current},w.flush=function(){return c.current?g(Date.now()):d.current},w},[j,f,t,b,m,v,x,y])}((0,s.useCallback)(function(e){return i(e)},[i]),800,t),h=(u=(0,s.useRef)(j)).current,h===j||(a(j),u.current=j),[l,a]),[b,g]=(0,s.useState)(),[p,w]=(0,s.useState)(""),[k,N]=(0,s.useState)(!1),[O,S]=(0,s.useState)(!1),[C,I]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{y.length>0&&o(y,x).then(e=>{"track"===x?g(e.tracks.items):g(e.artists.items),N(!1)}).catch(e=>{console.log(e),N(!1)})},[y]),(0,s.useEffect)(()=>{f.current.value&&N(!0),g(void 0)},[f.current.value]),{listOfSongs:b,link:p,handleOnChange:e=>{e.preventDefault(),m(f.current.value),S(!1),I(!1)},handleOnClick:(e,t)=>{if(g(void 0),N(!0),S(!1),I(!1),"track"===x)d(t,v,"track").then(e=>{console.log(e),S(!1),I(!0),N(!1)}).catch(e=>{console.log(e),S(!0),I(!1),N(!1)}),w(e);else{let n=e.substring(32);d(t,v,x).then(e=>{console.log(e),S(!1),I(!0),N(!1)}).catch(e=>{console.log(e),S(!0),I(!1),N(!1)}),w(n)}},songName:f,isLoading:k,error:O,done:C}},x=e=>{let{type:t}=e;return(0,l.jsx)("div",{className:"flex justify-center",children:"error"===t?(0,l.jsxs)("div",{className:"error",children:[(0,l.jsx)("div",{className:"error__icon",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",viewBox:"0 0 24 24",height:"24",fill:"none",children:(0,l.jsx)("path",{fill:"#393a37",d:"m13 13h-2v-6h2zm0 4h-2v-2h2zm-1-15c-1.3132 0-2.61358.25866-3.82683.7612-1.21326.50255-2.31565 1.23915-3.24424 2.16773-1.87536 1.87537-2.92893 4.41891-2.92893 7.07107 0 2.6522 1.05357 5.1957 2.92893 7.0711.92859.9286 2.03098 1.6651 3.24424 2.1677 1.21325.5025 2.51363.7612 3.82683.7612 2.6522 0 5.1957-1.0536 7.0711-2.9289 1.8753-1.8754 2.9289-4.4189 2.9289-7.0711 0-1.3132-.2587-2.61358-.7612-3.82683-.5026-1.21326-1.2391-2.31565-2.1677-3.24424-.9286-.92858-2.031-1.66518-3.2443-2.16773-1.2132-.50254-2.5136-.7612-3.8268-.7612z"})})}),(0,l.jsx)("div",{className:"error__title",children:"Error al a\xf1adir la canci\xf3n o el artista, vuelve a Intentarlo"})]}):(0,l.jsxs)("div",{className:"info",children:[(0,l.jsx)("div",{className:"info__icon",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",viewBox:"0 0 24 24",height:"24",fill:"none",children:(0,l.jsx)("path",{fill:"#393a37",d:"m12 1.5c-5.79844 0-10.5 4.70156-10.5 10.5 0 5.7984 4.70156 10.5 10.5 10.5 5.7984 0 10.5-4.7016 10.5-10.5 0-5.79844-4.7016-10.5-10.5-10.5zm.75 15.5625c0 .1031-.0844.1875-.1875.1875h-1.125c-.1031 0-.1875-.0844-.1875-.1875v-6.375c0-.1031.0844-.1875.1875-.1875h1.125c.1031 0 .1875.0844.1875.1875zm-.75-8.0625c-.2944-.00601-.5747-.12718-.7808-.3375-.206-.21032-.3215-.49305-.3215-.7875s.1155-.57718.3215-.7875c.2061-.21032.4864-.33149.7808-.3375.2944.00601.5747.12718.7808.3375.206.21032.3215.49305.3215.7875s-.1155.57718-.3215.7875c-.2061.21032-.4864.33149-.7808.3375z"})})}),(0,l.jsx)("div",{className:"info__title",children:"Cancion o Artista a\xf1adido correctamente."})]})})},v=e=>{let{type:t}=e,{handleOnChange:n,handleOnClick:s,listOfSongs:r,songName:c,isLoading:a,error:o,done:d}=h({type:t});return(0,l.jsxs)("form",{className:"flex flex-col",onSubmit:e=>{e.preventDefault()},children:[(0,l.jsx)("label",{htmlFor:"songName",className:"m-5",children:"track"===t?(0,l.jsx)("p",{children:"Introduce el Nombre de la Canci\xf3n"}):(0,l.jsx)("p",{children:"Introduce el Nombre del Artista"})}),(0,l.jsx)("input",{ref:c,type:"text",id:"songName",onChange:e=>{n(e)},className:"text-black mb-10"}),o?(0,l.jsx)(x,{type:"error"}):"",d?(0,l.jsx)(x,{type:"done"}):"",(0,l.jsx)("div",{className:"songs text-white flex flex-col gap-5 p-5",children:void 0!==r?null==r?void 0:r.map(e=>"track"===t?(0,l.jsxs)("div",{className:"song flex flex-row items-center border border-red-500 gap-5 p-2  cursor-pointer",onClick:()=>{s(e.external_urls.spotify,e)},children:[(0,l.jsx)("img",{src:e.album.images[2].url,alt:"",srcSet:""}),(0,l.jsxs)("p",{children:[e.name," - ",e.artists[0].name]})]},e.id):(0,l.jsxs)("div",{className:"song flex flex-row items-center border border-red-500 gap-5 p-2  cursor-pointer",onClick:()=>{s(e.external_urls.spotify,e)},children:[(0,l.jsx)("img",{src:null==e?void 0:e.images[2].url,height:100,width:100,alt:"",srcSet:""}),(0,l.jsx)("p",{children:e.name})]},e.id)):a?(0,l.jsx)("div",{className:"flex justify-center items-center",children:(0,l.jsx)(i.a,{})}):""})]})},j=()=>(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{children:"A\xf1adir nueva Cancion"}),(0,l.jsx)(v,{type:"track"})]}),m=()=>(0,l.jsx)(v,{type:"artist"}),f=()=>(0,l.jsx)(v,{type:"artistFollowers"}),y=e=>{let{type:t,database:n,userData:r}=e,[c,a]=(0,s.useState)([]),[o,d]=(0,s.useState)(null),[h,x]=(0,s.useState)(!0);return console.log("inicia"),(0,s.useEffect)(()=>{x(!0),u(n,r.userData.id).then(e=>{console.log(e),a(e),x(!1)}).catch(e=>{d(e),x(!1)})},[t,n]),(0,l.jsx)("div",{children:h?(0,l.jsx)(i.a,{}):o?(0,l.jsx)("p",{children:"Error"}):(0,l.jsxs)("div",{children:["canciones"===t&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-center pb-10",style:{color:"green"},children:"Spotify Actualizado"}),(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Portada"}),(0,l.jsx)("th",{children:"Nombre"}),(0,l.jsx)("th",{children:"Artista"}),(0,l.jsx)("th",{children:"Reproducciones"}),(0,l.jsx)("th",{children:"Aumento 24h"}),(0,l.jsx)("th",{children:"Mas Info"})]})}),(0,l.jsx)("tbody",{children:null==c?void 0:c.map(e=>(0,l.jsxs)("tr",{className:"text-center",children:[(0,l.jsx)("td",{children:(0,l.jsx)("img",{src:null==e?void 0:e.coverLink,alt:null==e?void 0:e.songName,height:75,width:75,className:"block m-auto"})}),(0,l.jsx)("td",{children:null==e?void 0:e.songName}),(0,l.jsx)("td",{children:null==e?void 0:e.artistName}),(0,l.jsx)("td",{children:(null==e?void 0:e.viewsTest)!==null&&(null==e?void 0:e.viewsTest)!==void 0&&Object.values(null==e?void 0:e.viewsTest)[Object.keys(e.viewsTest).length-1]}),(0,l.jsx)("td",{children:(null==e?void 0:e.viewsTest)!==null&&(null==e?void 0:e.viewsTest)!==void 0&&void 0===Object.values(null==e?void 0:e.viewsTest)[1]?"0":(null==e?void 0:e.viewsTest)!==null&&(null==e?void 0:e.viewsTest)!==void 0&&(0,l.jsxs)("span",{className:Object.values(null==e?void 0:e.viewsTest)[Object.keys(e.viewsTest).length-1]-Object.values(null==e?void 0:e.viewsTest)[Object.keys(e.viewsTest).length-2]>0?"text-green-500":"text-red-500",children:["+",Object.values(null==e?void 0:e.viewsTest)[1]-Object.values(null==e?void 0:e.viewsTest)[0]]})}),(0,l.jsx)("td",{children:"Click"})]},null==e?void 0:e.id))})]})]}),"oyentes"===t&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-center pb-10",style:{color:"green"},children:"Spotify Actualizado"}),(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Portada"}),(0,l.jsx)("th",{children:"Artista"}),(0,l.jsx)("th",{children:"Oyentes Mensuales"}),(0,l.jsx)("th",{children:"Aumento 24h"}),(0,l.jsx)("th",{children:"Mas Info"})]})}),(0,l.jsx)("tbody",{children:null==c?void 0:c.map(e=>(0,l.jsxs)("tr",{className:"text-center",children:[(0,l.jsx)("td",{children:(0,l.jsx)("img",{src:null==e?void 0:e.coverlink,alt:null==e?void 0:e.artistname,height:75,width:75,className:"block m-auto"})}),(0,l.jsx)("td",{children:null==e?void 0:e.artistname}),(0,l.jsx)("td",{children:(null==e?void 0:e.monthlylisteners)!==null&&(null==e?void 0:e.monthlylisteners)!==void 0&&Object.values(null==e?void 0:e.monthlylisteners)[Object.keys(e.monthlylisteners).length-1]}),(0,l.jsx)("td",{children:(null==e?void 0:e.monthlylisteners)!==null&&(null==e?void 0:e.monthlylisteners)!==void 0&&void 0===Object.values(null==e?void 0:e.monthlylisteners)[1]?"0":(null==e?void 0:e.monthlylisteners)!==null&&(null==e?void 0:e.monthlylisteners)!==void 0&&(0,l.jsx)("span",{className:Object.values(null==e?void 0:e.monthlylisteners)[Object.keys(e.monthlylisteners).length-1]-Object.values(null==e?void 0:e.monthlylisteners)[Object.keys(e.monthlylisteners).length-2]>0?"text-green-500 before:content-['+']":" text-red-500 before:content-['-'] ",children:Object.values(null==e?void 0:e.monthlylisteners)[Object.keys(null==e?void 0:e.monthlylisteners).length-1]-Object.values(e.monthlylisteners)[Object.keys(e.monthlylisteners).length-2]})}),(0,l.jsx)("td",{children:"Click"})]},null==e?void 0:e.id))})]})]}),"seguidores"===t&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-center pb-10",style:{color:"green"},children:"Spotify Actualizado"}),(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Portada"}),(0,l.jsx)("th",{children:"Artista"}),(0,l.jsx)("th",{children:"Seguidores"}),(0,l.jsx)("th",{children:"Aumento 24h"}),(0,l.jsx)("th",{children:"Mas Info"})]})}),(0,l.jsx)("tbody",{children:null==c?void 0:c.map(e=>(0,l.jsxs)("tr",{className:"text-center",children:[(0,l.jsx)("td",{children:(0,l.jsx)("img",{src:null==e?void 0:e.coverlink,alt:null==e?void 0:e.artistname,height:75,width:75,className:"block m-auto"})}),(0,l.jsx)("td",{children:null==e?void 0:e.artistname}),(0,l.jsx)("td",{children:(null==e?void 0:e.monthlylisteners)!==null&&(null==e?void 0:e.monthlylisteners)!==void 0&&Object.values(null==e?void 0:e.monthlylisteners)[Object.keys(e.monthlylisteners).length-1]}),(0,l.jsx)("td",{children:(null==e?void 0:e.monthlylisteners)!==null&&(null==e?void 0:e.monthlylisteners)!==void 0&&void 0===Object.values(null==e?void 0:e.monthlylisteners)[1]?"0":(null==e?void 0:e.monthlylisteners)!==null&&(null==e?void 0:e.monthlylisteners)!==void 0&&(0,l.jsx)("span",{className:Object.values(null==e?void 0:e.monthlylisteners)[Object.keys(e.monthlylisteners).length-1]-Object.values(null==e?void 0:e.monthlylisteners)[Object.keys(e.monthlylisteners).length-2]>0?"text-green-500 before:content-['+']":" text-red-500 before:content-['-'] ",children:Object.values(null==e?void 0:e.monthlylisteners)[Object.keys(null==e?void 0:e.monthlylisteners).length-1]-Object.values(e.monthlylisteners)[Object.keys(e.monthlylisteners).length-2]})}),(0,l.jsx)("td",{children:"Click"})]},null==e?void 0:e.id))})]})]})]})})},b=e=>{let[t,n]=(0,s.useState)(),[r,i]=(0,s.useState)(),c=e=>{n(e)};return(0,l.jsxs)("div",{className:"flex flex-row mt-10 gap-28 justify-center",children:[(0,l.jsxs)("ul",{className:"flex  flex-col gap-5 mx-10",children:[(0,l.jsx)("li",{onClick:()=>{c((0,l.jsx)(j,{})),i(1)},className:1===r?"text-red-700":"",children:"A\xf1ador Seguimiento de Canci\xf3n"}),(0,l.jsx)("li",{onClick:()=>{c((0,l.jsx)(m,{})),i(2)},className:2===r?"text-red-700":"",children:"A\xf1adir Seguimiento de Oyentes Mensuales"}),(0,l.jsxs)("li",{onClick:()=>{c((0,l.jsx)(f,{})),i(3)},className:3===r?"text-red-700":"",children:[" ","A\xf1adir Seguimiento de Seguidores en Spotify"]}),(0,l.jsxs)("li",{onClick:()=>{c((0,l.jsx)(y,{type:"canciones",database:"spotifytracker",userData:e})),i(4)},className:4===r?"text-red-700":"",children:[" ","Oyentes Mensuales"]}),(0,l.jsxs)("li",{onClick:()=>{c((0,l.jsx)(y,{type:"oyentes",database:"monthlylistenerstracker",userData:e})),i(5)},className:5===r?"text-red-700":"",children:[" ","Seguimiento de Seguidores en Spotify"]}),(0,l.jsxs)("li",{onClick:()=>{c((0,l.jsx)(y,{type:"seguidores",database:"followerstracker",userData:e})),i(6)},className:6===r?"text-red-700":"",children:[" ","Seguidmiento Oyentes Mensuales"]})]}),(0,l.jsx)("div",{className:"mx-auto",children:t})]})},g=async()=>{let e=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"update=false"});return await e.json()};var p=()=>{let[e,t]=(0,s.useState)();(0,s.useEffect)(()=>{g().then(e=>{console.log(e),t(e)}).catch(e=>{console.log(e)})},[]);let n=(0,r.D)();return(0,l.jsx)("div",{children:void 0===n?(0,l.jsx)("div",{className:"flex items-center justify-center",children:(0,l.jsx)(i.a,{})}):null===n?window&&(window.location.href="/login"):(0,l.jsxs)("div",{children:[e&&(0,l.jsx)("p",{className:"true"===e.SpotifyUpdateChecker.SongViews.toString()?"text-center bg-green-600":"text-center bg-red-600",children:"true"===e.SpotifyUpdateChecker.SongViews.toString()?"Datos de Spotify Actualizados a dia ".concat(e.SpotifyUpdateChecker.LastUpdated):"Los Datos de Spotify aun no han sido actualizados durante el dia de hoy"}),(0,l.jsx)(b,{userData:n})]})})}},1575:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var l=n(7437);n(2265),n(5478);let s=()=>(0,l.jsx)("svg",{viewBox:"25 25 50 50",className:"svg",children:(0,l.jsx)("circle",{className:"circle",r:"20",cy:"50",cx:"50"})})},2060:function(e,t,n){"use strict";n.d(t,{IsUserLoggedContext:function(){return c},S:function(){return i}});var l=n(7437),s=n(2265),r=n(9649);let i=(0,s.createContext)(null),c=e=>{let{children:t}=e,[n,c]=(0,s.useState)(),a=async()=>{c(await (0,r.Z)())};return(0,s.useEffect)(()=>{a().catch(e=>{console.log(e)})},[]),(0,l.jsx)(i.Provider,{value:n,children:t})}},7194:function(e,t,n){"use strict";n.d(t,{D:function(){return r}});var l=n(2265),s=n(2060);let r=()=>(0,l.useContext)(s.S)},9649:function(e,t,n){"use strict";n.d(t,{k:function(){return r}});let l=(0,n(1375).eI)("https://xgjzaayvyresnqvqrwbj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhnanphYXl2eXJlc25xdnFyd2JqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQyMTMyMTcsImV4cCI6MjAyOTc4OTIxN30.UgCpovpE4g9ABhx7jVMkBIV1N18miADiB7mGJOCkOA4"),s=async()=>{let{data:{user:e}}=await l.auth.getUser();return e},r=async()=>{let{error:e}=await l.auth.signOut();console.log(e)};t.Z=s},5478:function(){}},function(e){e.O(0,[227,375,971,23,744],function(){return e(e.s=5)}),_N_E=e.O()}]);